import{d as k,u as b,k as V,r as y,o as x,f as I,w as r,b as t,h as s,j as R,g as l,R as P,M as n,S as j,T as m,U as p,V as B,W as C}from"./index-BUgfj_ir.js";import{I as S}from"./index-DLNtBgUN.js";import{I as U}from"./index-D8ajxOCt.js";const F="/image/icon/qq.png",N=l("div",{class:"title"},"用户登录",-1),T=l("div",{class:"label"},"第三方登录",-1),E=l("img",{src:F,alt:"qq登录"},null,-1),L=[E],A=k({__name:"gvb_login_form",props:{qqRedirectPath:{type:String}},emits:["ok"],setup(u,{expose:f,emit:_}){const g=_,v=b(),a=V({user_name:"",password:""}),i=y();function q(){i.value.resetFields(Object.keys(a)),i.value.clearValidate(Object.keys(a))}f({formReset:q});async function h(){if(await i.value.validate())return;let e=await P(a);if(e.code){n.error(e.msg);return}n.success(e.msg),v.setToken(e.data),g("ok")}const c=u;async function w(){let o=await j();if(o.code){n.error(o.msg);return}if(o.data===""){n.warning("未配置qq登录");return}let e=location.pathname;console.log("当前path",e),c.qqRedirectPath&&(e=c.qqRedirectPath),localStorage.setItem("redirectPath",e),window.open(o.data,"_self")}return(o,e)=>(x(),I(s(C),{class:"gvb_login_form",ref_key:"formRef",ref:i,model:a,"label-col-props":{span:0},"wrapper-col-props":{span:24}},{default:r(()=>[N,t(s(m),{field:"user_name",label:"用户名",rules:[{required:!0,message:"请输入用户名"}],"validate-trigger":["blur"]},{default:r(()=>[t(s(p),{modelValue:a.user_name,"onUpdate:modelValue":e[0]||(e[0]=d=>a.user_name=d),placeholder:"用户名"},{prefix:r(()=>[t(s(S))]),_:1},8,["modelValue"])]),_:1}),t(s(m),{field:"password",label:"密码",rules:[{required:!0,message:"请输入密码"}],"validate-trigger":["blur"]},{default:r(()=>[t(s(p),{type:"password",modelValue:a.password,"onUpdate:modelValue":e[1]||(e[1]=d=>a.password=d),placeholder:"密码"},{prefix:r(()=>[t(s(U))]),_:1},8,["modelValue"])]),_:1}),t(s(B),{type:"primary",onClick:h},{default:r(()=>[R("登录")]),_:1}),l("div",{class:"other-login"},[T,l("div",{class:"icons"},[l("a",{href:"javascript:void(0)",onClick:w},L)])])]),_:1},8,["model"]))}});export{A as _};
