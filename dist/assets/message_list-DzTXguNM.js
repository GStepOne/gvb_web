import{d as V,k as m,r as v,a as h,o as l,c as r,g as e,b as g,y as D,q as f,F as x,e as B,M as z,x as A,t as k}from"./index-BUgfj_ir.js";import{_ as y}from"./gvb_message_list.vue_vue_type_style_index_0_lang-CCow2dmc.js";import{c as I,d as L,a as M}from"./message_api-iUw8swaY.js";const N={class:"message_list_view"},R={class:"user_list_menu"},E={class:"head"},F={class:"page"},K={key:0,class:"user_menu"},S={key:1,class:"user_record_menu"},b=["src"],q={class:"message-main"},$={class:"message-user"},j={class:"message-content"},G={class:"content"},H={class:"txt-message"},T=V({__name:"message_list",setup(J){const d=m({list:[],count:0}),o=m({list:[],count:0}),u=v(0),p=v(0),i=m({page:1,limit:10,nickname:void 0});async function _(){let t=await I(i);d.list=t.data.list,d.count=t.data.count}_();async function U(t){c.list=o.list=[],c.count=o.count=0;let s=t.user_id,n=await L(s);u.value=s,o.list=n.data.list,o.count=n.data.count}async function C(t){p.value=t.user_id,console.log("发信人"+u.value,"收信人"+p.value);let s=await M(u.value,p.value);if(s.code){z.error(s.msg);return}s.data.list.forEach(n=>{n.is_me=n.send_user_id==u.value}),c.list=s.data.list,c.count=s.data.count}const c=m({list:[],count:0});return(t,s)=>{const n=h("a-input-search"),w=h("a-pagination");return l(),r("div",N,[e("div",R,[e("div",E,[g(n,{placeholder:"搜索用户名",modelValue:i.nickname,"onUpdate:modelValue":s[0]||(s[0]=a=>i.nickname=a),onSearch:_,onKeydown:D(_,["enter"])},null,8,["modelValue"])]),g(y,{onCheck:U,data:d.list},null,8,["data"]),e("div",F,[g(w,{simple:"",total:d.count,current:i.page,"onUpdate:current":s[1]||(s[1]=a=>i.page=a),"page-size":i.limit,onChange:_},null,8,["total","current","page-size"])])]),o.list.length?(l(),r("div",K,[g(y,{onCheck:C,data:o.list},null,8,["data"])])):f("",!0),c.list.length?(l(),r("div",S,[(l(!0),r(x,null,B(c.list,a=>(l(),r("div",{class:A({message:!0,is_me:a.is_me})},[e("img",{class:"avatar",src:a.send_user_avatar,alt:"发送人头像"},null,8,b),e("div",q,[e("div",$,k(a.send_user_nickname),1),e("div",j,[e("div",G,[e("div",H,k(a.content),1)])])])],2))),256))])):f("",!0)])}}});export{T as default};
